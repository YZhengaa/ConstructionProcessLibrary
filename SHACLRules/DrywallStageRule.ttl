@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix schema: <http://schema.org/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix bot: <https://w3id.org/bot#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix ex: <http://example.aalto.fi#> .
@prefix sosa: <http://www.w3.org/ns/sosa/> .
@prefix dicp: <https://w3id.org/digitalconstruction/0.5/Processes#> .
@prefix dice: <https://w3id.org/digitalconstruction/0.5/Entities#> .
@prefix dicv: <https://w3id.org/digitalconstruction/0.5/Variables#> .
@prefix dica: <https://w3id.org/digitalconstruction/0.5/Agents#> .
@prefix dicm: <https://w3id.org/digitalconstruction/0.5/Materials#> .
@prefix time: <http://www.w3.org/2006/time#> .

ex:DrywallStageRule a dicr:Rule;
 dicr:hasCreationTime “2023-05-22”^^xsd:Date;
 dicr:hasKnowledgeSource “https:// https://www.rakennustietokauppa.fi/sivu/tuote/ratu-f52-0327-kevyen-valiseinan-purku-ja-uusiminen-levyseinat-menekit-ja-menetelmat/2743115.”^^xsd:anyURI;
 dicr:hasDataSource ex:DrywallImageSemantics;
 dicr:hasBody ex:DrywallStageRuleShape;
 dicr:hasBodyURL “https://raw.githubusercontent.com/YZhengaa/ConstructionProcessLibrary/main/SHACLRules/DrywallStageRule.ttl”^^xsd:anyURI;
 dicr:hasDiscipline ex:DrywallInstallation.

ex:DrywallStageRuleShape a sh:NodeShape,rdfs:Class;
sh:targetClass dicp:Activity;
 sh:sparql [
        a sh:SPARQLConstraint ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "the activity is at Not started stage from the image." ;
        sh:select """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            SELECT $this 
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasObject ?drywall  .
                ?drywall  dice:hasMemberPart ?frame .
                ?frame a  dice:DrywallFrame .
                ?frame dicv:hasProperty  ?framevisibility .
                ?framevisibility a dicv:Property. 
                ?framevisibility dicv:hasPropertyState ?framevisibilitystate.
                ?framevisibilitystate a dicv:PropertyState.
                ?framevisibilitystate dicv:hasValue ?framevisibilityvalue. 
                ?drywall  dice:hasMemberPart ?wire .
                ?wire a  dice:DrywallWire .
                ?wire dicv:hasProperty  ?wirevisibility .
                ?wirevisibility a dicv:Property. 
                ?wirevisibility dicv:hasPropertyState ?wirevisibilitystate.
                ?wirevisibilitystate a dicv:PropertyState.
                ?wirevisibilitystate dicv:hasValue ?wirevisibilityvalue.
                ?drywall  dice:hasMemberPart ?backpanel .
                ?backpanel a  dice:DrywallBackpanel .
                ?backpanel dicv:hasProperty  ?backpanelvisibility .
                ?backpanelvisibility a dicv:Property. 
                ?backpanelvisibility dicv:hasPropertyState ?backpanelvisibilitystate.
                ?backpanelvisibilitystate a dicv:PropertyState.
                ?backpanelvisibilitystate dicv:hasValue ?backpanelvisibilityvalue.
                ?drywall  dice:hasMemberPart ?frontpanel .
                ?frontpanel a  dice:DrywallFrontpanel .
                ?frontpanel dicv:hasProperty  ?frontpanelvisibility .
                ?frontpanelvisibility a dicv:Property. 
                ?frontpanelvisibility dicv:hasPropertyState ?frontpanelvisibilitystate.
                ?frontpanelvisibilitystate a dicv:PropertyState.
                ?frontpanelvisibilitystate dicv:hasValue ?frontpanelvisibilityvalue.

                
                 FILTER (?framevisibilityvalue =”False”|| ?wirevisibilityvalue=”False”|| ?backpanelvisibilityvalue=”False”|| ?frontpanelvisibilityvalue =”False”) .        
            }
            """
];
  sh:sparql [
        a sh:SPARQLConstraint ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "the activity is at framing stage from the image." ;
        sh:select """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            SELECT $this
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasObject ?drywall  .
                ?drywall  dice:hasMemberPart ?frame .
                ?frame a  dice:DrywallFrame .
                ?frame dicv:hasProperty  ?framevisibility .
                ?framevisibility a dicv:Property. 
                ?framevisibility dicv:hasPropertyState ?framevisibilitystate.
                ?framevisibilitystate a dicv:PropertyState.
                ?framevisibilitystate dicv:hasValue ?framevisibilityvalue. 
                ?drywall  dice:hasMemberPart ?wire .
                ?wire a  dice:DrywallWire .
                ?wire dicv:hasProperty  ?wirevisibility .
                ?wirevisibility a dicv:Property. 
                ?wirevisibility dicv:hasPropertyState ?wirevisibilitystate.
                ?wirevisibilitystate a dicv:PropertyState.
                ?wirevisibilitystate dicv:hasValue ?wirevisibilityvalue.
                ?drywall  dice:hasMemberPart ?backpanel .
                ?backpanel a  dice:DrywallBackpanel .
                ?backpanel dicv:hasProperty  ?backpanelvisibility .
                ?backpanelvisibility a dicv:Property. 
                ?backpanelvisibility dicv:hasPropertyState ?backpanelvisibilitystate.
                ?backpanelvisibilitystate a dicv:PropertyState.
                ?backpanelvisibilitystate dicv:hasValue ?backpanelvisibilityvalue.
                ?drywall  dice:hasMemberPart ?frontpanel .
                ?frontpanel a  dice:DrywallFrontpanel .
                ?frontpanel dicv:hasProperty  ?frontpanelvisibility .
                ?frontpanelvisibility a dicv:Property. 
                ?frontpanelvisibility dicv:hasPropertyState ?frontpanelvisibilitystate.
                ?frontpanelvisibilitystate a dicv:PropertyState.
                ?frontpanelvisibilitystate dicv:hasValue ?frontpanelvisibilityvalue.

                
                 FILTER (?framevisibilityvalue =”True”|| ?wirevisibilityvalue =”False”|| ?backpanelvisibilityvalue=”False”|| ?frontpanelvisibilityvalue =”False”) .        

            }
            """
];
sh:sparql [
        a sh:SPARQLConstraint ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "the activity is at wiring stage from the image." ;
        sh:select """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            SELECT $this ex:hasState ex:Wiring}
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasObject ?drywall  .
                ?drywall  dice:hasMemberPart ?frame .
                ?frame a  dice:DrywallFrame .
                ?frame dicv:hasProperty  ?framevisibility .
                ?framevisibility a dicv:Property. 
                ?framevisibility dicv:hasPropertyState ?framevisibilitystate.
                ?framevisibilitystate a dicv:PropertyState.
                ?framevisibilitystate dicv:hasValue ?framevisibilityvalue. 
                ?drywall  dice:hasMemberPart ?wire .
                ?wire a  dice:DrywallWire .
                ?wire dicv:hasProperty  ?wirevisibility .
                ?wirevisibility a dicv:Property. 
                ?wirevisibility dicv:hasPropertyState ?wirevisibilitystate.
                ?wirevisibilitystate a dicv:PropertyState.
                ?wirevisibilitystate dicv:hasValue ?wirevisibilityvalue.
                ?drywall  dice:hasMemberPart ?backpanel .
                ?backpanel a  dice:DrywallBackpanel .
                ?backpanel dicv:hasProperty  ?backpanelvisibility .
                ?backpanelvisibility a dicv:Property. 
                ?backpanelvisibility dicv:hasPropertyState ?backpanelvisibilitystate.
                ?backpanelvisibilitystate a dicv:PropertyState.
                ?backpanelvisibilitystate dicv:hasValue ?backpanelvisibilityvalue.
                ?drywall  dice:hasMemberPart ?frontpanel .
                ?frontpanel a  dice:DrywallFrontpanel .
                ?frontpanel dicv:hasProperty  ?frontpanelvisibility .
                ?frontpanelvisibility a dicv:Property. 
                ?frontpanelvisibility dicv:hasPropertyState ?frontpanelvisibilitystate.
                ?frontpanelvisibilitystate a dicv:PropertyState.
                ?frontpanelvisibilitystate dicv:hasValue ?frontpanelvisibilityvalue.

                
                 FILTER (?framevisibilityvalue =”True”|| ?wirevisibilityvalue =”True”|| ?backpanelvisibilityvalue=”False”|| ?frontpanelvisibilityvalue =”False”) .        

            }
            """
];
sh:sparql [
        a sh:SPARQLConstraint ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "the activity is at stage Back Panel from the image." ;
        sh:select """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            SELECT $this 
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasObject ?drywall  .
                ?drywall  dice:hasMemberPart ?frame .
                ?frame a  dice:DrywallFrame .
                ?frame dicv:hasProperty  ?framevisibility .
                ?framevisibility a dicv:Property. 
                ?framevisibility dicv:hasPropertyState ?framevisibilitystate.
                ?framevisibilitystate a dicv:PropertyState.
                ?framevisibilitystate dicv:hasValue ?framevisibilityvalue. 
                ?drywall  dice:hasMemberPart ?wire .
                ?wire a  dice:DrywallWire .
                ?wire dicv:hasProperty  ?wirevisibility .
                ?wirevisibility a dicv:Property. 
                ?wirevisibility dicv:hasPropertyState ?wirevisibilitystate.
                ?wirevisibilitystate a dicv:PropertyState.
                ?wirevisibilitystate dicv:hasValue ?wirevisibilityvalue.
                ?drywall  dice:hasMemberPart ?backpanel .
                ?backpanel a  dice:DrywallBackpanel .
                ?backpanel dicv:hasProperty  ?backpanelvisibility .
                ?backpanelvisibility a dicv:Property. 
                ?backpanelvisibility dicv:hasPropertyState ?backpanelvisibilitystate.
                ?backpanelvisibilitystate a dicv:PropertyState.
                ?backpanelvisibilitystate dicv:hasValue ?backpanelvisibilityvalue.
                ?drywall  dice:hasMemberPart ?frontpanel .
                ?frontpanel a  dice:DrywallFrontpanel .
                ?frontpanel dicv:hasProperty  ?frontpanelvisibility .
                ?frontpanelvisibility a dicv:Property. 
                ?frontpanelvisibility dicv:hasPropertyState ?frontpanelvisibilitystate.
                ?frontpanelvisibilitystate a dicv:PropertyState.
                ?frontpanelvisibilitystate dicv:hasValue ?frontpanelvisibilityvalue.

                
                 FILTER (?framevisibilityvalue =”True”|| ?wirevisibilityvalue =”True”|| ?backpanelvisibilityvalue=”True”|| ?frontpanelvisibilityvalue =”False”) .        

            }
            """
];
sh:sparql [
        a sh:SPARQLConstraint ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "the activity is at Front Panel stage from the image." ;
        sh:select """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            SELECT $this 
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasObject ?drywall  .
                ?drywall  dice:hasMemberPart ?frame .
                ?frame a  dice:DrywallFrame .
                ?frame dicv:hasProperty  ?framevisibility .
                ?framevisibility a dicv:Property. 
                ?framevisibility dicv:hasPropertyState ?framevisibilitystate.
                ?framevisibilitystate a dicv:PropertyState.
                ?framevisibilitystate dicv:hasValue ?framevisibilityvalue. 
                ?drywall  dice:hasMemberPart ?wire .
                ?wire a  dice:DrywallWire .
                ?wire dicv:hasProperty  ?wirevisibility .
                ?wirevisibility a dicv:Property. 
                ?wirevisibility dicv:hasPropertyState ?wirevisibilitystate.
                ?wirevisibilitystate a dicv:PropertyState.
                ?wirevisibilitystate dicv:hasValue ?wirevisibilityvalue.
                ?drywall  dice:hasMemberPart ?backpanel .
                ?backpanel a  dice:DrywallBackpanel .
                ?backpanel dicv:hasProperty  ?backpanelvisibility .
                ?backpanelvisibility a dicv:Property. 
                ?backpanelvisibility dicv:hasPropertyState ?backpanelvisibilitystate.
                ?backpanelvisibilitystate a dicv:PropertyState.
                ?backpanelvisibilitystate dicv:hasValue ?backpanelvisibilityvalue.
                ?drywall  dice:hasMemberPart ?frontpanel .
                ?frontpanel a  dice:DrywallFrontpanel .
                ?frontpanel dicv:hasProperty  ?frontpanelvisibility .
                ?frontpanelvisibility a dicv:Property. 
                ?frontpanelvisibility dicv:hasPropertyState ?frontpanelvisibilitystate.
                ?frontpanelvisibilitystate a dicv:PropertyState.
                ?frontpanelvisibilitystate dicv:hasValue ?frontpanelvisibilityvalue.
                
                 FILTER (?framevisibilityvalue =”False”|| ?wirevisibilityvalue =”False”|| ?backpanelvisibilityvalue=”False”|| ?frontpanelvisibilityvalue =”True”) .        

            }
            """
    ].
