ex:DrywallTemperatureRule a dicr:Rule;
 dicr:hasCreationTime “2022-08-22”^^xsd:Date;
 dicr:hasKnowledgeSource “https://www.usg.com/content/dam/USG_Marketing_Communications/united_states/product_promotional_materials/finished_assets/evaluating-jobsite-environmental-conditions-white-paper-en-J2074.pdf”^^xsd:anyURI;
 dicr:hasDataSource ex:TemperatureSensorSystem;
 dicr:hasBody ex:DrywallTemperatureRuleShape;
dicr:hasBodyURL “https://raw.githubusercontent.com/YZhengaa/ConstructionProcessLibrary/main/SHACLRules/DrywallTemperatureRule.ttl”^^xsd:anyURI;
 dicr:hasDiscipline ex:DrywallInstallation .

ex:DrywallTemperatureRuleShape a sh:NodeShape,rdfs:Class;
sh:targetClass dicp:Activity;
 sh:rule [
        a sh:SPARQLRule ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "Drywall installation is able to conduct, temperature satisfied." ;
        sh:construct """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            CONSTRUCT { $this expp:hasState expp:AbleToOperate}
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasLocation ?location .
                $this dicp:hasStartTime ?StartTime  .
                $this dicp:hasEndTime ?EndTime  .
                ?location a dice:Location .
                ?location dicv:hasProperty ?locationtemperatureproperty .
                ?locationtemperatureproperty a dicv:QuantitativeProperty .
                ?locationtemperatureproperty dicv:hasPropertyState ?locationtemperaturepropertystate .
                ?locationtemperaturepropertystate a dicv:PropertyState. 
                ?locationtemperaturepropertystate dicv:hasValue ?value. 
                ?locationtemperaturepropertystate dicv:hasTimeOfCreation ?resultTime .

                FILTER (?value > 3.3|| ?value < 32 ||?resultTime < ?EndTime||?resultTime > ?StartTime) .
            }
            """
];
  sh:rule [
        a sh:SPARQLRule ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "Drywall installation is not able to conduct, the temperature is too low." ;
        sh:construct """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            CONSTRUCT { $this expp:hasState expp:NotAbleToOperate}
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasLocation ?location .
                $this dicp:hasStartTime ?StartTime  .
                $this dicp:hasEndTime ?EndTime  .
                ?location a dice:Location .
                ?location dicv:hasProperty ?locationtemperatureproperty .
                ?locationtemperatureproperty a dicv:QuantitativeProperty .
                ?locationtemperatureproperty dicv:hasPropertyState ?locationtemperaturepropertystate .
                ?locationtemperaturepropertystate a dicv:PropertyState. 
                ?locationtemperaturepropertystate dicv:hasValue ?value. 
                ?locationtemperaturepropertystate dicv:hasTimeOfCreation ?resultTime .

                FILTER (?value < 3.3 ||?resultTime < ?EndTime||?resultTime > ?StartTime) .
            }
            """
];
sh:rule [
        a sh:SPARQLRule ;
        sh:prefixes ex: ;
        sh:prefixes sosa: ;
        sh:prefixes dicp: ;
        sh:prefixes bot: ;
        sh:prefixes dice: ;
        sh:prefixes rdfs: ;
        sh:message "Drywall installation is able to conduct, temperature is too high." ;
        sh:construct """
            PREFIX ex: <http://example.aalto.fi#>
            PREFIX dicp: <https://w3id.org/digitalconstruction/0.5/Processes#>
            PREFIX sh: <http://www.w3.org/ns/shacl#>
            PREFIX sosa: <http://www.w3.org/ns/sosa/>
            PREFIX bot: <https://w3id.org/bot#>
            CONSTRUCT { $this expp:hasState expp:AbleToOperate}
            WHERE {
                $this a dicp:Activity .
                $this dicp:hasLocation ?location .
                $this dicp:hasStartTime ?StartTime  .
                $this dicp:hasEndTime ?EndTime  .
                ?location a dice:Location .
                ?location dicv:hasProperty ?locationtemperatureproperty .
                ?locationtemperatureproperty a dicv:QuantitativeProperty .
                ?locationtemperatureproperty dicv:hasPropertyState ?locationtemperaturepropertystate .
                ?locationtemperaturepropertystate a dicv:PropertyState. 
                ?locationtemperaturepropertystate dicv:hasValue ?value. 
                ?locationtemperaturepropertystate dicv:hasTimeOfCreation ?resultTime .

                FILTER (?value > 32||?resultTime < ?EndTime||?resultTime > ?StartTime) .
            }
            """
].
